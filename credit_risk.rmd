---
title: "Credit Risk"
author: "Filip Mordarski & Mateusz Wasielewski"
date: "5 12 2020"
header-includes:
  - \usepackage[polish]{babel}
output: 
  pdf_document:
toc: true
toc_depth: 2
number_sections: true
---

```{r, include=FALSE}

library(generator)
library(dplyr)
library(rjson)
rm(list = ls())

# paths
#################################################
base_path <- getwd()
output_path <- paste0(base_path, "/data")

# libnames
#################################################


clients <- read.csv2(paste0(output_path, "/clients.csv"))
loans <- read.csv2(paste0(output_path, "/loans.csv"))

data <- left_join(clients, loans, by='ID')
data <- data[-8]
```

# Wstęp

Poniższy raport będzie zawierał analizę modelu ryzyka kredytowego.

# Tworzenie zmiennych objaśniających

W pierwszej kolejności zostały utworzone zmienne objaśniające potrzebne do modelu PD. Pierwszą zmienną, która została wygenerowana na podstawie utworzonych wcześniej zmiennych jest wiek. Został wyliczony okres trwania umowy w latach na podstawie różnicy między obecną datą a wartością w zmiennej *agreement_start*. Następnie został wygenerowany wektor wartości z rozkładu gamma z parametrem kształtu równym 3 oraz parametrem skali równym 2. Wiek został wyznaczony dodając do siebie: czas trwania umowy, liczbę 18 (wiek kiedy człowiek może podpisać wiążącą umowę kredytową) oraz wylosowaną wartość z rozkładu gamma, oznaczającą różnicę w latach pomiędzy datą podpisania umowy a osiągnięciem pełnoletności. Poniższy wykres przedstawia gęstość tej utworzonej zmiennej w naszym zbiorze.

```{r, include=FALSE}
# tworzenie zmiennych
set.seed(1892)
# sprawdzamy czas trwania umow
agreement_time <- abs(as.numeric((Sys.Date()-as.Date(data$agreement_start))/365))
data$age <- round(agreement_time+18+rgamma(5000,shape=3,scale=2),0)
plot(density(data$age))
```

Następnie została wygenerowana zmienna, oznaczająca roczny dochód klienta. Wartości te zostały wylosowane z rozkładu normalnego, gdzie średnia została przyjęta na poziomie 87,864 USD (na podst)

data$salary_gross <- round(rnorm(5000,5230,500),0)
plot(density(data$salary_gross))
summary(data$salary_gross)

data$single <- sample.int(2,5000,replace = T)-1
unique(data$single)
data$in_relation <- sample.int(2,5000,replace = T)-1
unique(data$in_relation)

data$kids <- round(rgamma(5000,shape=2,scale=0.6),0)
unique(data$kids)
plot(density(data$kids))
hist(data$kids)

```
